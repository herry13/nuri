#!/bin/bash

DIR="$( cd "$( dirname "$0" )" && pwd )"
NURI="/usr/bin/ruby $DIR/nuri"
PIDFILE="$(cd "$DIR" && cd .. && pwd )/var/nuri.pid"

if [ "$1" = "restart" ]; then
	# stop Nuri client daemon
	$NURI client stop
	# stop Nuri client daemon
	nice $NURI client start
elif [ -f "$PIDFILE" ] && [ "$1" = "start" ]; then
	# check if the nuri daemon is running
	PIDS="$( cat "$PIDFILE" )"
	IFS=' ' read -a PIDS <<< "$PIDS"
	DATA="$( ps "${PIDS[0]}" | grep nuri )"
	if [ "$DATA" = "" ]; then
		# daemon is not running
		nice $NURI client $@
	else
		#Â print a message
		PIDS="$( cat "$PIDFILE" )"
		echo "Nuri client is running with PIDs: $PIDS"
	fi
else
	nice $NURI client $@
fi
