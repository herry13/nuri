class Machine {
	running = no
	procedure start {
		cost = 5
		condition { }
		effect {
			this.running = yes
		}
	}
	procedure stop {
		cost = 10
		condition { }
		effect {
			this.running = no
		}
	}
}

class PM extends Machine {
	has_vm isref VM

	procedure stop {
		cost = 10
		condition {
			this.has_vm.running = false
		}
		effect {
			this.running = no
		}
	}
}

class VM extends Machine {
	pm isref PM
	has_service isref Service

	procedure start {
		cost = 5
		condition {
			this.pm.running = true
		}
		effect {
			this.running = true
		}
	}
	procedure stop {
		cost = 10
		condition {
			this.has_service.running = false
		}
		effect {
			this.running = false
		}
	}
}

class Service {
	vm isref VM
	running = false

	procedure start {
		cost = 5
		condition {
			this.vm.running = true
		}
		effect {
			this.running = true
		}
	}
	procedure stop {
		cost = 10
		condition { }
		effect {
			this.running = false
		}
	}
}

class Client {
	refer isref Service
	procedure change(s isref Service) {
		condition {
			s.running = yes
		}
		effect {
			this.refer = s
		}
	}
}
